<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>TienHuyIoT ‚Äì Sonic WiFi Config</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg-main: #02030a;
      --bg-card: #050718;
      --accent: #00f5ff;
      --accent-alt: #ff00ff;
      --accent-soft: rgba(0, 245, 255, 0.18);
      --text-main: #f8f9ff;
      --text-sub: #8e9ac0;
      --border-soft: #1a2138;
      --danger: #ff4d4f;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", sans-serif;
      background:
        radial-gradient(circle at top, #151a3d 0, #02030a 55%, #000000 100%),
        #000;
      margin: 0;
      padding: 2.4rem 1.2rem;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: var(--text-main);
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .layout {
      max-width: 1120px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      align-items: stretch;
      justify-content: center;
      gap: 2.2rem;
    }

    .card {
      position: relative;
      overflow: hidden;
      background:
        radial-gradient(circle at 0 0, rgba(0, 245, 255, 0.18), transparent 60%),
        radial-gradient(circle at 100% 0, rgba(255, 0, 255, 0.16), transparent 55%),
        var(--bg-card);
      padding: 2.1rem 1.85rem 1.7rem;
      border-radius: 24px;
      max-width: 460px;
      width: 100%;
      box-shadow:
        0 22px 55px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(0, 245, 255, 0.1);
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        conic-gradient(from 160deg, rgba(0, 245, 255, 0.18), transparent, rgba(255, 0, 255, 0.18), transparent),
        radial-gradient(circle at 50% 120%, rgba(0, 245, 255, 0.18), transparent 60%);
      mix-blend-mode: screen;
      opacity: 0.5;
      pointer-events: none;
      z-index: -1;
    }

    .brand-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      margin-bottom: 0.8rem;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.15rem 0.8rem;
      border-radius: 999px;
      font-size: 0.76rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--accent);
      background: rgba(0, 245, 255, 0.06);
      border: 1px solid rgba(0, 245, 255, 0.5);
      backdrop-filter: blur(10px);
    }

    .badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 12px var(--accent);
    }

    .clickable {
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.12s ease, background 0.12s ease;
    }

    .clickable:hover {
      transform: translateY(-0.6px);
      box-shadow: 0 0 16px rgba(0, 245, 255, 0.35);
      background-color: rgba(0, 0, 0, 0.1);
    }

    .menu-wrapper {
      position: relative;
    }

    .tag-btn {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      padding: 0.16rem 0.7rem;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      color: var(--text-sub);
      background: rgba(0, 0, 0, 0.25);
      white-space: nowrap;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }

    .tag-arrow {
      font-size: 0.7rem;
    }

    .link-menu {
      position: absolute;
      top: 130%;
      right: 0;
      width: 310px;
      max-width: min(320px, 80vw);
      background: rgba(5, 7, 25, 0.98);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      box-shadow:
        0 16px 40px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(0, 245, 255, 0.18);
      padding: 0.9rem 0.85rem;
      font-size: 0.8rem;
      z-index: 20;
      display: none;
    }

    .link-menu.visible {
      display: block;
    }

    .menu-item {
      padding: 0.45rem 0.45rem;
      border-radius: 10px;
      transition: background 0.12s ease;
    }

    .menu-item + .menu-item {
      margin-top: 0.25rem;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    .menu-title {
      font-weight: 600;
      margin-bottom: 0.2rem;
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .menu-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem;
      margin-bottom: 0.2rem;
    }

    .menu-link-pill {
      padding: 0.15rem 0.55rem;
      border-radius: 999px;
      border: 1px solid rgba(0, 245, 255, 0.45);
      font-size: 0.73rem;
      color: var(--accent);
      background: rgba(0, 245, 255, 0.08);
    }

    .menu-desc {
      color: var(--text-sub);
      font-size: 0.76rem;
    }

    .logo-line {
      display: flex;
      align-items: center;
      gap: 0.55rem;
      margin-bottom: 0.25rem;
    }

    .logo-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      overflow: hidden;
      flex-shrink: 0;
      box-shadow: 0 0 12px rgba(0, 245, 255, 0.55);
      border: 1px solid rgba(255, 255, 255, 0.15);
      background: #012;
    }

    .logo-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .logo-main {
      font-size: 1.45rem;
      font-weight: 800;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: linear-gradient(120deg, var(--accent), var(--accent-alt));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      display: inline-block;
    }

    .logo-main:hover {
      text-shadow: 0 0 14px rgba(0, 245, 255, 0.6);
      transform: translateY(-0.4px);
    }

    .logo-sub {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-sub);
    }

    h2 {
      margin: 0.1rem 0 0.4rem;
      font-size: 1.22rem;
      display: flex;
      align-items: center;
      gap: 0.45rem;
    }

    h2 span.icon {
      font-size: 1.3rem;
      filter: drop-shadow(0 0 8px rgba(0, 245, 255, 0.7));
    }

    .subtitle {
      margin: 0 0 1.55rem;
      font-size: 0.9rem;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .subtitle span {
      color: var(--accent);
      font-weight: 500;
    }

    label {
      font-weight: 600;
      display: block;
      margin: 1rem 0 0.35rem;
      font-size: 0.9rem;
    }

    .input-wrapper {
      position: relative;
    }

    .input-prefix {
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.9rem;
      color: var(--text-sub);
    }

    input[type="text"],
    input[type="password"] {
      width: 100%;
      padding: 0.76rem 0.85rem 0.76rem 2.3rem;
      font-size: 0.95rem;
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      background: radial-gradient(circle at top left, rgba(0, 245, 255, 0.08), transparent 55%),
                  rgba(3, 6, 24, 0.96);
      color: var(--text-main);
      outline: none;
      transition:
        border-color 0.16s ease,
        box-shadow 0.16s ease,
        background 0.16s ease,
        transform 0.06s ease;
    }

    input[type="text"]::placeholder,
    input[type="password"]::placeholder {
      color: #5f6c8e;
    }

    input[type="text"]:focus,
    input[type="password"]:focus {
      border-color: var(--accent);
      box-shadow:
        0 0 0 1px rgba(0, 245, 255, 0.7),
        0 0 18px rgba(0, 245, 255, 0.3);
      background: rgba(4, 8, 32, 0.98);
      transform: translateY(-0.6px);
    }

    .checkbox-container {
      margin-top: 0.8rem;
      font-size: 0.86rem;
      color: var(--text-sub);
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .checkbox-container input[type="checkbox"] {
      width: 17px;
      height: 17px;
      accent-color: var(--accent);
      cursor: pointer;
    }

    .btn-row {
      display: grid;
      grid-template-columns: 1.4fr 1fr;
      gap: 0.7rem;
      margin-top: 1.5rem;
    }

    button {
      padding: 0.8rem 0.8rem;
      font-size: 0.95rem;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      transition:
        background-color 0.15s ease,
        box-shadow 0.15s ease,
        transform 0.06s ease,
        opacity 0.12s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.3rem;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(130deg, var(--accent), var(--accent-alt));
      color: #020305;
      font-weight: 650;
      box-shadow:
        0 12px 30px rgba(0, 245, 255, 0.45),
        0 0 22px rgba(255, 0, 255, 0.25);
    }

    .btn-primary:hover {
      box-shadow:
        0 16px 36px rgba(0, 245, 255, 0.7),
        0 0 28px rgba(255, 0, 255, 0.35);
      transform: translateY(-0.8px);
    }

    .btn-primary:active {
      box-shadow:
        0 7px 20px rgba(0, 245, 255, 0.4),
        0 0 18px rgba(255, 0, 255, 0.2);
      transform: translateY(0.3px) scale(0.992);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.03);
      color: var(--text-main);
      border: 1px solid rgba(255, 255, 255, 0.18);
      backdrop-filter: blur(10px);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-0.5px);
    }

    .btn-secondary:active {
      transform: translateY(0.2px) scale(0.994);
      background: rgba(255, 255, 255, 0.04);
    }

    .btn-download {
      margin-top: 0.7rem;
      width: 100%;
      font-size: 0.9rem;
    }

    .btn-download:disabled {
      opacity: 0.35;
      cursor: not-allowed;
      box-shadow: none;
    }

    audio {
      margin-top: 1.35rem;
      width: 100%;
      outline: none;
      filter: drop-shadow(0 0 14px rgba(0, 245, 255, 0.35));
      border-radius: 999px;
    }

    .hint {
      margin-top: 0.85rem;
      font-size: 0.8rem;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .hint span {
      color: var(--accent);
      font-weight: 500;
    }

    .signature {
      margin-top: 0.65rem;
      font-size: 0.78rem;
      color: #657094;
      text-align: right;
      opacity: 0.9;
    }

    .signature span {
      background: linear-gradient(120deg, var(--accent), var(--accent-alt));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 600;
    }

    .guide-card {
      max-width: 420px;
      width: 100%;
      border-radius: 22px;
      padding: 1.9rem 1.7rem 1.6rem;
      background:
        radial-gradient(circle at top right, rgba(255, 0, 255, 0.22), transparent 60%),
        rgba(5, 8, 30, 0.96);
      border: 1px solid rgba(120, 130, 180, 0.35);
      box-shadow:
        0 18px 40px rgba(0, 0, 0, 0.75),
        0 0 0 1px rgba(255, 255, 255, 0.03);
      color: var(--text-main);
    }

    .guide-title {
      font-size: 1rem;
      font-weight: 700;
      margin: 0 0 0.8rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .guide-title span.icon {
      font-size: 1.2rem;
    }

    .guide-intro {
      margin: 0 0 1rem;
      font-size: 0.86rem;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .steps {
      list-style: none;
      padding: 0;
      margin: 0 0 1.1rem;
      counter-reset: step;
    }

    .steps li {
      position: relative;
      padding-left: 2.1rem;
      margin-bottom: 0.75rem;
      font-size: 0.85rem;
      line-height: 1.5;
      color: var(--text-main);
    }

    .steps li::before {
      counter-increment: step;
      content: counter(step);
      position: absolute;
      left: 0;
      top: 0.2rem;
      width: 1.4rem;
      height: 1.4rem;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #ffffff, var(--accent-alt));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 700;
      color: #020010;
      box-shadow: 0 0 14px rgba(255, 0, 255, 0.8);
    }

    .steps li span.tag {
      border-radius: 999px;
      padding: 0.05rem 0.55rem;
      font-size: 0.73rem;
      margin-left: 0.35rem;
      border-color: rgba(0, 245, 255, 0.4);
      color: var(--accent);
      background: rgba(0, 245, 255, 0.08);
    }

    .guide-highlight {
      margin-top: 0.5rem;
      padding: 0.7rem 0.75rem;
      border-radius: 14px;
      font-size: 0.8rem;
      background: rgba(0, 0, 0, 0.55);
      border: 1px dashed rgba(0, 245, 255, 0.4);
      color: var(--text-sub);
    }

    .guide-highlight strong {
      color: var(--accent);
    }

    .guide-errors-title {
      margin: 1rem 0 0.4rem;
      font-size: 0.88rem;
      font-weight: 600;
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .error-list {
      margin: 0;
      padding-left: 1.1rem;
      font-size: 0.8rem;
      color: var(--text-sub);
      line-height: 1.5;
    }

    .error-list li + li {
      margin-top: 0.25rem;
    }

    @media (max-width: 920px) {
      .layout {
        flex-direction: column;
        align-items: center;
        gap: 1.8rem;
      }
      .card,
      .guide-card {
        max-width: 520px;
      }
      .link-menu {
        right: auto;
        left: 0;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 1.8rem 1.05rem;
      }
      .card {
        padding: 1.75rem 1.3rem 1.45rem;
        border-radius: 20px;
      }
      .guide-card {
        padding: 1.6rem 1.25rem 1.4rem;
        border-radius: 18px;
      }
      .logo-main {
        font-size: 1.35rem;
      }
      h2 {
        font-size: 1.15rem;
      }
      .btn-row {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="layout">
    <div class="card" id="tienhuy-sonic-card">
      <div class="brand-row">
        <a
          class="badge clickable"
          href="https://zalo.me/g/fsyuiz890"
          target="_blank"
          rel="noopener noreferrer"
        >
          <span class="badge-dot"></span>
          TienHuyIoT ¬∑ Sonic WiFi Config
        </a>

        <div class="menu-wrapper">
          <button class="tag-btn clickable" id="robot-menu-toggle" type="button">
            RoBot5320 edition
            <span class="tag-arrow" id="robot-menu-arrow">‚ñæ</span>
          </button>

          <div class="link-menu" id="robot-menu">
            <div class="menu-item">
              <div class="menu-title">üì± Zalo ‚Äì Nh√≥m h·ªó tr·ª£ ch√≠nh th·ª©c</div>
              <div class="menu-links">
                <a
                  href="https://zalo.me/g/ghwomx800"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >Nh√≥m 1</a>
                <a
                  href="https://zalo.me/g/fsyuiz890"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >Nh√≥m 2</a>
              </div>
              <div class="menu-desc">Tham gia nh√≥m ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£ tr·ª±c ti·∫øp, h·ªèi ƒë√°p v·ªÅ Xiaozhi AI‚ÄìIoT.</div>
            </div>

            <div class="menu-item">
              <div class="menu-title">üìò Facebook Community</div>
              <div class="menu-links">
                <a
                  href="https://www.facebook.com/share/g/17mkTxx1oQ/"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >Group</a>
                <a
                  href="https://www.facebook.com/share/1BhraxqFBb/?mibextid=wwXIfr"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >Fanpage</a>
              </div>
              <div class="menu-desc">C·ªông ƒë·ªìng chia s·∫ª d·ª± √°n, h√¨nh ·∫£nh s·∫£n ph·∫©m v√† update firmware m·ªõi.</div>
            </div>

            <div class="menu-item">
              <div class="menu-title">üé• YouTube ‚Äì Video h∆∞·ªõng d·∫´n</div>
              <div class="menu-links">
                <a
                  href="https://youtu.be/g7Lh-LpxElU"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >Xem video</a>
              </div>
              <div class="menu-desc">H∆∞·ªõng d·∫´n chi ti·∫øt t·ª´ A‚ÄìZ: l·∫Øp r√°p, n·∫°p firmware, c·∫•u h√¨nh WiFi.</div>
            </div>

            <div class="menu-item">
              <div class="menu-title">üéµ TikTok ‚Äì RoBot5320</div>
              <div class="menu-links">
                <a
                  href="https://www.tiktok.com/@robot.5320?is_from_webapp=1&sender_device=pc"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >@robot.5320</a>
              </div>
              <div class="menu-desc">Xem demo th·ª±c t·∫ø, m·∫πo ch∆°i ƒë·ªì IoT v√† update nhanh.</div>
            </div>

            <div class="menu-item">
              <div class="menu-title">üåç Website RoBot5320</div>
              <div class="menu-links">
                <a
                  href="https://robotntq.netlify.app/"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >Website</a>
              </div>
              <div class="menu-desc">T√†i li·ªáu, firmware, h∆∞·ªõng d·∫´n chi ti·∫øt cho c√°c board h·ªó tr·ª£.</div>
            </div>

            <div class="menu-item">
              <div class="menu-title">ü§ñ ChatRoBot5320 ‚Äì Server AI</div>
              <div class="menu-links">
                <a
                  href="https://robot5320xiaozhi-backend.onrender.com"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >M·ªü chat</a>
              </div>
              <div class="menu-desc">K·∫øt n·ªëi tr·ª±c ti·∫øp Xiaozhi AI v·ªõi server ri√™ng c·ªßa RoBot5320.</div>
            </div>

            <div class="menu-item">
              <div class="menu-title">üîß Web Flasher ‚Äì N·∫°p firmware</div>
              <div class="menu-links">
                <a
                  href="https://tienhuyiot.github.io/esp_web_flasher/"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="menu-link-pill"
                >M·ªü Web Flasher</a>
              </div>
              <div class="menu-desc">N·∫°p firmware cho ESP32 ngay tr√™n tr√¨nh duy·ªát, kh√¥ng c·∫ßn c√†i th√™m tool.</div>
            </div>
          </div>
        </div>
      </div>

      <div class="logo-line">
        <div class="logo-avatar">
          <img src="tienhuy_logo.png" alt="TienHuyIoT Logo" />
        </div>
        <div>
          <a
            class="logo-main"
            href="https://www.facebook.com/XiaozhiAI.IoTVietnam?mibextid=wwXIfr&rdid=M1TC4WlMyMQa9fHz&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F1BhraxqFBb%2F%3Fmibextid%3DwwXIfr%23"
            target="_blank"
            rel="noopener noreferrer"
          >
            TienHuyIoT
          </a>
          <div class="logo-sub">wifi sonic tool</div>
        </div>
      </div>

      <h2>
        <span class="icon">üéß</span>
        B·∫Øn c·∫•u h√¨nh WiFi b·∫±ng s√≥ng √¢m
      </h2>

      <p class="subtitle">
        Nh·∫≠p <span>SSID</span> v√† <span>m·∫≠t kh·∫©u</span> WiFi, c√¥ng c·ª• s·∫Ω t·∫°o m·ªôt file √¢m thanh ƒë·∫∑c bi·ªát ƒë·ªÉ ESP32
        c·ªßa TienHuyIoT nghe v√† t·ª± k·∫øt n·ªëi m·∫°ng.
      </p>

      <label for="ssid">T√™n WiFi (SSID)</label>
      <div class="input-wrapper">
        <span class="input-prefix">üì°</span>
        <input id="ssid" type="text" value="" placeholder="Nh·∫≠p t√™n WiFi (v√≠ d·ª•: TienHuy_Lab)" />
      </div>

      <label for="pwd">M·∫≠t kh·∫©u WiFi</label>
      <div class="input-wrapper">
        <span class="input-prefix">üîê</span>
        <input id="pwd" type="password" value="" placeholder="Nh·∫≠p m·∫≠t kh·∫©u WiFi" />
      </div>

      <div class="checkbox-container">
        <input type="checkbox" id="loopCheck" checked />
        <label for="loopCheck">T·ª± ƒë·ªông l·∫∑p l·∫°i √¢m thanh c·∫•u h√¨nh cho t·ªõi khi ESP32 b·∫Øt ƒë∆∞·ª£c</label>
      </div>

      <div class="btn-row">
        <button class="btn-primary" id="btn-generate" type="button">‚ö° T·∫°o & ph√°t √¢m thanh</button>
        <button class="btn-secondary" id="btn-stop" type="button">‚èπÔ∏è D·ª´ng ph√°t</button>
      </div>

      <button class="btn-secondary btn-download" id="btn-download" type="button" disabled>
        ‚¨áÔ∏è T·∫£i file WAV v·ªÅ m√°y
      </button>

      <audio id="player" controls></audio>

      <p class="hint">
        G·ª£i √Ω: <span>TƒÉng √¢m l∆∞·ª£ng ƒëi·ªán tho·∫°i kho·∫£ng 70‚Äì90%</span>, ƒë·∫∑t loa s√°t thi·∫øt b·ªã ESP32, sau ƒë√≥ nh·∫•n
        ‚ÄúT·∫°o & ph√°t √¢m thanh‚Äù ƒë·ªÉ b·∫Øt ƒë·∫ßu c·∫•u h√¨nh.
      </p>

      <div class="signature">
        T·∫∑ng ri√™ng cho <span>TienHuyIoT</span> ¬∑ Dev: RoBot5320
      </div>
    </div>

    <div class="guide-card">
      <h3 class="guide-title">
        <span class="icon">üìò</span>
        H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng cho kh√°ch
      </h3>
      <p class="guide-intro">
        ƒê√¢y l√† c√¥ng c·ª• c·∫•u h√¨nh WiFi cho thi·∫øt b·ªã ESP32 c·ªßa TienHuyIoT b·∫±ng √¢m thanh. Ch·ªâ c·∫ßn v√†i b∆∞·ªõc l√† thi·∫øt b·ªã s·∫Ω t·ª± k·∫øt n·ªëi m·∫°ng, kh√¥ng c·∫ßn v√†o web c·∫•u h√¨nh.
      </p>

      <ol class="steps">
        <li>
          Chu·∫©n b·ªã ƒëi·ªán tho·∫°i ho·∫∑c laptop c√≥ loa, v√† b·∫≠t s·∫µn trang <strong>TienHuyIoT ‚Äì Sonic WiFi Config</strong>.
          ƒê·∫∑t thi·∫øt b·ªã ESP32 ·ªü n∆°i y√™n tƒ©nh, tr√°nh ·ªìn qu√° l·ªõn.
        </li>
        <li>
          ·ªû khung b√™n tr√°i, nh·∫≠p ƒë√∫ng <strong>t√™n WiFi (SSID)</strong> v√† <strong>m·∫≠t kh·∫©u WiFi</strong> ƒëang d√πng.
          N√™n d√πng m·∫°ng 2.4GHz n·∫øu router c√≥ c·∫£ 2.4G v√† 5G.
        </li>
        <li>
          ƒê∆∞a loa l·∫°i g·∫ßn micro c·ªßa thi·∫øt b·ªã ESP32 (kho·∫£ng 5‚Äì20&nbsp;cm), sau ƒë√≥ b·∫•m n√∫t
          <strong>‚Äú‚ö° T·∫°o &amp; ph√°t √¢m thanh‚Äù</strong>. Gi·ªØ nguy√™n v·ªã tr√≠ cho ƒë·∫øn khi thi·∫øt b·ªã b√°o ƒë√£ nh·∫≠n c·∫•u h√¨nh.
          <span class="tag">Auto repeat</span>
        </li>
        <li>
          Khi ESP32 nghe xong, t√πy firmware s·∫Ω c√≥ ti·∫øng b√≠p, ƒë√®n LED ƒë·ªïi m√†u ho·∫∑c th√¥ng b√°o tr√™n m√†n h√¨nh cho bi·∫øt
          ƒë√£ k·∫øt n·ªëi WiFi th√†nh c√¥ng.
        </li>
        <li>
          N·∫øu mu·ªën g·ª≠i cho ng∆∞·ªùi kh√°c d√πng offline, sau khi t·∫°o √¢m thanh h√£y b·∫•m
          <strong>‚ÄúT·∫£i file WAV v·ªÅ m√°y‚Äù</strong> ƒë·ªÉ l∆∞u file v√† c√≥ th·ªÉ ph√°t l·∫°i b·∫±ng b·∫•t k·ª≥ tr√¨nh ph√°t nh·∫°c n√†o.
        </li>
      </ol>

      <div class="guide-highlight">
        <strong>M·∫πo nh·ªè:</strong> N·∫øu l·∫ßn ƒë·∫ßu ch∆∞a ƒÉn, h√£y tƒÉng √¢m l∆∞·ª£ng l√™n th√™m m·ªôt ch√∫t, gi·ªØ kho·∫£ng c√°ch loa c·ªë ƒë·ªãnh,
        r·ªìi b·∫•m ph√°t l·∫°i. Tr√°nh ƒë·ªÉ loa qu√° s√°t micro l√†m √¢m b·ªã r√®.
      </div>

      <div class="guide-errors-title">
        L·ªói th∆∞·ªùng g·∫∑p
      </div>
      <ul class="error-list">
        <li>ESP32 kh√¥ng v√†o ƒë∆∞·ª£c m·∫°ng: ki·ªÉm tra l·∫°i SSID ho·∫∑c m·∫≠t kh·∫©u c√≥ vi·∫øt hoa, k√Ω t·ª± ƒë·∫∑c bi·ªát hay kho·∫£ng tr·∫Øng th·ª´a kh√¥ng.</li>
        <li>Thi·∫øt b·ªã kh√¥ng ph·∫£n h·ªìi: th·ª≠ ƒë·ªïi sang WiFi 2.4GHz, ho·∫∑c ƒë∆∞a loa g·∫ßn h∆°n v√† gi·∫£m ti·∫øng ·ªìn xung quanh.</li>
        <li>√Çm thanh nghe r√®: gi·∫£m b·ªõt √¢m l∆∞·ª£ng ho·∫∑c ƒë·ªïi thi·∫øt b·ªã ph√°t kh√°c (tai nghe loa nh·ªè s·∫Ω kh√≥ nh·∫≠n h∆°n loa ngo√†i to).</li>
      </ul>
    </div>
  </div>

  <script>
    const ROBOT5320_MARK = 1800;
    const ROBOT5320_SPACE = 1500;
    const ROBOT5320_SAMPLE_RATE = 44100;
    const ROBOT5320_BIT_RATE = 100;
    const ROBOT5320_START_BYTES = [0x01, 0x02];
    const ROBOT5320_END_BYTES = [0x03, 0x04];
    let robot5320LastUrl = null;

    function robot5320Checksum(data) {
      return data.reduce(function (sum, b) {
        return (sum + b) & 0xff;
      }, 0);
    }

    function robot5320ToBits(byte) {
      const bits = [];
      for (let i = 7; i >= 0; i--) {
        bits.push((byte >> i) & 1);
      }
      return bits;
    }

    function robot5320AfskModulate(bits) {
      const samplesPerBit = ROBOT5320_SAMPLE_RATE / ROBOT5320_BIT_RATE;
      const totalSamples = Math.floor(bits.length * samplesPerBit);
      const buffer = new Float32Array(totalSamples);
      for (let i = 0; i < bits.length; i++) {
        const freq = bits[i] ? ROBOT5320_MARK : ROBOT5320_SPACE;
        for (let j = 0; j < samplesPerBit; j++) {
          const t = (i * samplesPerBit + j) / ROBOT5320_SAMPLE_RATE;
          buffer[i * samplesPerBit + j] = Math.sin(2 * Math.PI * freq * t);
        }
      }
      return buffer;
    }

    function robot5320FloatTo16BitPCM(floatSamples) {
      const buffer = new Uint8Array(floatSamples.length * 2);
      for (let i = 0; i < floatSamples.length; i++) {
        const s = Math.max(-1, Math.min(1, floatSamples[i]));
        const val = s < 0 ? s * 0x8000 : s * 0x7fff;
        buffer[i * 2] = val & 0xff;
        buffer[i * 2 + 1] = (val >> 8) & 0xff;
      }
      return buffer;
    }

    function robot5320BuildWav(pcm) {
      const wavHeader = new Uint8Array(44);
      const dataLen = pcm.length;
      const fileLen = 36 + dataLen;

      function writeStr(offset, str) {
        for (let i = 0; i < str.length; i++) {
          wavHeader[offset + i] = str.charCodeAt(i);
        }
      }

      function write32(offset, value) {
        wavHeader[offset] = value & 0xff;
        wavHeader[offset + 1] = (value >> 8) & 0xff;
        wavHeader[offset + 2] = (value >> 16) & 0xff;
        wavHeader[offset + 3] = (value >> 24) & 0xff;
      }

      function write16(offset, value) {
        wavHeader[offset] = value & 0xff;
        wavHeader[offset + 1] = (value >> 8) & 0xff;
      }

      writeStr(0, "RIFF");
      write32(4, fileLen);
      writeStr(8, "WAVE");
      writeStr(12, "fmt ");
      write32(16, 16);
      write16(20, 1);
      write16(22, 1);
      write32(24, ROBOT5320_SAMPLE_RATE);
      write32(28, ROBOT5320_SAMPLE_RATE * 2);
      write16(32, 2);
      write16(34, 16);
      writeStr(36, "data");
      write32(40, dataLen);

      return new Blob([wavHeader, pcm], { type: "audio/wav" });
    }

    function robot5320Generate() {
      robot5320StopPlay();
      const ssid = document.getElementById("ssid").value.trim();
      const pwd = document.getElementById("pwd").value.trim();
      const dataStr = ssid + "\n" + pwd;
      const textBytes = Array.from(new TextEncoder().encode(dataStr));
      const fullBytes = ROBOT5320_START_BYTES.concat(
        textBytes,
        [robot5320Checksum(textBytes)],
        ROBOT5320_END_BYTES
      );

      let bits = [];
      fullBytes.forEach(function (b) {
        bits = bits.concat(robot5320ToBits(b));
      });

      const floatBuf = robot5320AfskModulate(bits);
      const pcmBuf = robot5320FloatTo16BitPCM(floatBuf);
      const wavBlob = robot5320BuildWav(pcmBuf);

      const audio = document.getElementById("player");
      if (robot5320LastUrl) {
        URL.revokeObjectURL(robot5320LastUrl);
      }
      const url = URL.createObjectURL(wavBlob);
      robot5320LastUrl = url;

      audio.src = url;
      audio.load();
      audio.play();

      const loopCheck = document.getElementById("loopCheck");
      if (loopCheck && loopCheck.checked) {
        audio.onended = function () {
          audio.currentTime = 0;
          audio.play();
        };
      } else {
        audio.onended = null;
      }

      const downloadBtn = document.getElementById("btn-download");
      if (downloadBtn) {
        downloadBtn.disabled = false;
      }
    }

    function robot5320StopPlay() {
      const audio = document.getElementById("player");
      if (audio) {
        audio.pause();
        audio.currentTime = 0;
        audio.onended = null;
      }
    }

    function robot5320Download() {
      if (!robot5320LastUrl) return;
      const a = document.createElement("a");
      a.href = robot5320LastUrl;
      a.download = "TienHuyIoT_wifi_config.wav";
      document.body.appendChild(a);
      a.click();
      a.remove();
    }

    document.getElementById("btn-generate").addEventListener("click", robot5320Generate);
    document.getElementById("btn-stop").addEventListener("click", robot5320StopPlay);
    document.getElementById("btn-download").addEventListener("click", robot5320Download);

    const robotMenuToggle = document.getElementById("robot-menu-toggle");
    const robotMenu = document.getElementById("robot-menu");
    const robotArrow = document.getElementById("robot-menu-arrow");

    robotMenuToggle.addEventListener("click", function () {
      const visible = robotMenu.classList.toggle("visible");
      robotArrow.textContent = visible ? "‚ñ¥" : "‚ñæ";
    });

    document.addEventListener("click", function (e) {
      if (!robotMenu.contains(e.target) && !robotMenuToggle.contains(e.target)) {
        if (robotMenu.classList.contains("visible")) {
          robotMenu.classList.remove("visible");
          robotArrow.textContent = "‚ñæ";
        }
      }
    });
  </script>
</body>
</html>
